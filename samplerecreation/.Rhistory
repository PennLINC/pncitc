setwd('/Users/kahinim/Desktop/ITC/samplerecreation')
# read the subject demographics
restdatapnc=read.csv('n2416_RestQAData_20170714.csv') # pnc QA for resting-state data
nmel=read.csv('n452_pnc_itc_whole_sample_20160825.csv') # Marieta final subject QA
z = read.csv('n427_fsSubcortVol.csv')
pncitc=merge(nmel,restdatapnc, by=c('bblid','scanid')) # merge by Ids
pncitc=merge(pncitc,z, by=c('bblid','scanid')) # merge by Ids
# select the neccessary variable for screening and further processing
# age, logk, sex, rest exclusion  variables: voxelwise and motion
pncit1 <- data.frame(
pncitc$bblid,
pncitc$healthExclude,
pncitc$scanid,
pncitc$logk,
pncitc$ageAtScan,
pncitc$logAlpha,pncitc$sex,pncitc$race,pncitc$race2,pncitc$restExclude,pncitc$restExcludeVoxelwise,
pncitc$restNoDataExclude,pncitc$relMeanRMSmotion,pncitc$restNSpikesMotion,pncitc$restNSpikesMotionExclude,pncitc$restRelMeanRMSMotionExclude, pncitc$restNoDataExclude, pncitc$restVoxelwiseCoverageExclude, pncitc$meduCnbGo1, pncitc$feduCnbGo1
)
colnames(pncit1)=c('bblid','healthExclude',
'scanid','logk','ageAtScan','logAlpha','sex','race','race2','restExclude','restExcludeVoxelwise',
'restNoDataExclude','relMeanRMSmotion','restNSpikesMotion','restNSpikesMotionExclude','restRelMeanRMSMotionExclude','restNoDataExclude', 'restVoxelwiseCoverageExclude', 'Medu', 'Fedu')
pncit1=pncit1[which(pncit1$restExcludeVoxelwise==0),]
pncit1=pncit1[which(pncit1$restNoDataExclude==0),]
pncit1=pncit1[which(pncit1$restRelMeanRMSMotionExclude==0),]
pncit1=pncit1[which(pncit1$restVoxelwiseCoverageExclude==0),]
pncit1=pncit1[which(pncit1$healthExclude==0),]
pncit1=pncit1[which(pncit1$restNSpikesMotionExclude==0),]
pncit1=pncit1[-which(is.na(pncit1$relMeanRMSmotion)),]
# during manual checking, one subject (id:96832) has data points 90 less than 120 expected
pncit1=pncit1[-which(pncit1$bblid==96832),]
#get the ids of final subjects
ids=data.frame(pncit1$bblid,pncit1$scanid) # get bblid and scanid for futher analyses
# write out demographics and bblid and scanid
write.csv(ids,'n293_blbid_scanid.csv',row.names = FALSE,quote = FALSE)
pncit1$age=pncit1$ageAtScan/12
write.csv(pncit1,'n293_demographics.csv',row.names = FALSE,quote = FALSE)
pncit1=read.csv('n293_demographics.csv')
medu = pncit1$Medu # average of mat and pat edu
fedu = pncit1$Fedu
edu = (medu+fedu)/2
pncit1$edu = edu
pncit1=pncit1[which(pncit1$edu>0.0),] # remove NaN values
write.csv(pncit1,'n282_demographics.csv',row.names = FALSE,quote = FALSE)
lm(pncit1$logk~edu)
lm(pncit1$logk~pncit1$edu)
summary(lm(pncit1$logk~pncit1$edu))
fuck
